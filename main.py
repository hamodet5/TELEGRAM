import asyncio
import random
import threading
import requests
from datetime import datetime, timezone, timedelta
from telethon import TelegramClient, events
from http.server import BaseHTTPRequestHandler, HTTPServer

# --- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ---
API_ID = 38972492 
API_HASH = '59edb6a86e3f130732b8a0c64510cd40'
PHONE_NUMBER = '+9647844101857' 
TARGET_GROUP = 'stevenalbaghdadichat'

BOT_TOKEN = '7394386222:AAHMuvrYSYwKplbyiAQXbfDbifbfEdztk_k'
MY_ID = '5803355350'

# --- ğŸ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø© ÙˆØ§Ù„Ø¶Ø®Ù…Ø© (40 Ø¹Ø¨Ø§Ø±Ø© Ù…Ù†ÙˆØ¹Ø©) ---
MY_MESSAGES = [
    "Ø§Ù„ÙƒÙ„ ÙŠØªÙƒÙ„Ù… Ø¨Ø³ Ø§Ù„Ù‚Ù†Ø§Ø© ØªØ«Ø¨Øª Ø§Ù„ÙØ¹Ù„.. Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù„Ø§ ØªØµØ¯Ù‚Ù†ÙŠØŒ ØªØ¹Ø§Ù„ÙŠ ÙˆØ´ÙˆÙ Ø§Ù„Ø«Ø¨Ø§Øª Ø¨Ø¹ÙŠÙ†Ùƒ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ Ù‚Ø¨Ù„ Ù„Ø§ ØªÙ‚Ø±Ø±",
    "Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ù…Ùˆ Ù…Ø¬Ø±Ø¯ Ù…Ù‚Ø§Ø·Ø¹ØŒ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø£ÙƒØ¨Ø± Ù…Ù† ÙƒØ°Ø§.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ØªØ¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ø´ÙŠØ¡ Ø§Ù„Ù„ÙŠ Ù…Ø§ Ø´ÙØªÙ‡ Ù‚Ø¨Ù„ØŸ Ø§Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø§ÙŠÙˆ ÙˆØ¨ØªØ¹Ø±Ù",
    "Ø³Ø± Ù†Ø¬Ø§Ø­ÙŠ ÙˆØ§Ø³ØªØ±Ø²Ø§Ù‚ÙŠ ÙƒÙ„Ù‡ Ø­Ø§Ø·ØªÙ‡ Ø¨Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø£ÙˆÙ„ 5 ÙŠØ¯Ø®Ù„ÙˆÙ† Ø§Ù„Ù‚Ù†Ø§Ø© Ù„Ù‡Ù… Ø´ÙŠØ¡ Ø®Ø§ØµØŒ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ ØªÙ†Ø²Ù„ Ù„ÙØªØ±Ø© ÙˆØªÙ†Ø­Ø°ÙØŒ Ø§Ù„Ø­Ù‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ Ù‚Ø¨Ù„ ØªØ±ÙˆØ­",
    "Ù…Ùˆ Ø£ÙŠ Ø´Ø®Øµ ÙŠÙ‚Ø¯Ø± ÙŠØ´ÙˆÙ Ø§Ù„Ù„ÙŠ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ù†Ø§Ø©ØŒ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ Ù„Ù„Ø¬Ø§Ø¯ÙŠÙ† ÙÙ‚Ø·",
    "Ù…Ùˆ ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø§Ù„ÙÙ„ÙˆØ³ØŒ ÙÙŠ Ø£Ø´ÙŠØ§Ø¡ Ù…Ø¬Ø§Ù†ÙŠØ© Ø¨Ø§Ù„Ù‚Ù†Ø§Ø© Ø¹Ø´Ø§Ù† ØªØªØ£ÙƒØ¯ Ø¨Ù†ÙØ³Ùƒ.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù†Ø²Ù„Øª Ù…Ù‚Ø·Ø¹ Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„ÙƒÙ„ Ø¨Ø§Ù„Ù‚Ù†Ø§Ø©ØŒ Ø§Ù„Ø­Ù‚ Ø¹Ù„ÙŠÙ‡ Ù‚Ø¨Ù„ Ù„Ø§ ÙŠØªØ­ÙˆÙ„ Ø®Ø§Øµ.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù„Ù„ÙŠ Ù…Ø§ ÙŠÙ‚Ø¯Ø± ÙŠØ¯ÙØ¹ØŒ ÙÙŠ Ù…ÙØ§Ø¬Ø£Ø© Ù„ÙƒÙ… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø­ÙŠÙ†.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ØªØ¨ÙŠ ØªØ¹Ø±Ù ÙƒÙŠÙ ØªØ³ØªØ±Ø²Ù‚ Ù…Ø«Ù„ÙŠØŸ Ø¨Ø¯Ø£Øª Ù…Ù† Ø§Ù„ØµÙØ±.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø£Ù†Ø§ Ø¨Ø¯Ø£Øª Ù…Ù† Ù„Ø§ Ø´ÙŠØ¡ ÙˆØ£Ø­Ø¨ Ø£Ø³Ø§Ø¹Ø¯ Ø§Ù„ÙƒÙ„ØŒ Ø§Ø¯Ø®Ù„ Ø§Ù„Ù‚Ù†Ø§Ø© ÙˆØ´ÙˆÙ Ø§Ù„Ù…Ø«Ø¨Øª.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù„Ø±Ø²Ù‚ ÙŠØ­Ø¨ Ø§Ù„Ø³Ø¹ÙŠØŒ Ø§Ù†Ø¶Ù… Ù„Ù‚Ù†Ø§ØªÙŠ ÙˆØ±Ø§Ø­ ØªÙØªØ­ Ù„Ùƒ Ø£Ø¨ÙˆØ§Ø¨ Ø¬Ø¯ÙŠØ¯Ø©.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ØªØ¨ØºÙ‰ ØªØ¹Ø±Ù Ù„ÙŠØ´ Ø§Ù„ÙƒÙ„ Ù…Ù†Ø¶Ù… Ø¹Ù†Ø¯ÙŠØŸ Ø§Ù„Ø¬ÙˆØ§Ø¨ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ØªØ¹Ø¨Øª Ù…Ù† Ø§Ù„ÙˆØ¹ÙˆØ¯ Ø§Ù„ÙƒØ§Ø°Ø¨Ø©ØŸ ØªØ¹Ø§Ù„ Ø¹Ù†Ø¯ÙŠ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ ÙˆØ´ÙˆÙ Ø§Ù„ØµØ¯Ù‚",
    "Ù…Ø§ Ø£Ø­ØªØ§Ø¬ Ø£Ù…Ø¯Ø­ Ù†ÙØ³ÙŠØŒ Ø§Ù„Ù‚Ù†Ø§Ø© ØªØ­ÙƒÙŠ Ø¹Ù†ÙŠ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø¨Ø§Ù‚ÙŠ Ø®Ø·ÙˆØ§Øª Ø¨Ø³ÙŠØ·Ø© ÙˆØªØ¯Ø®Ù„ Ø¹Ø§Ù„Ù…ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù…Ø¬Ø±Ø¯ Ø¶ØºØ·Ø© Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø§ÙŠÙˆ ÙˆØ¨ØªÙÙ‡Ù… ÙƒÙ„ Ø´ÙŠØ¡",
    "Ù…Ù‚Ø§Ø·Ø¹ Ù„Ù„Ø¬Ø§Ø¯ÙŠÙ† ÙÙ‚Ø·ØŒ ÙˆØ§Ù„Ø±Ø²Ù‚ ÙŠØ­Ø¨ Ø§Ù„Ø®ÙÙŠØ©.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù† Ù‚Ø¨Ù„ Ù…Ø§ ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø­ØªÙ‰ Ù„Ùˆ Ù…Ø§ Ø¹Ù†Ø¯Ùƒ Ù…ÙŠØ²Ø§Ù†ÙŠØ©ØŒ Ø§Ø¯Ø®Ù„ Ø§Ù„Ù‚Ù†Ø§Ø© ÙˆØ§Ø³ØªÙÙŠØ¯ Ù…Ù† Ø§Ù„Ù„ÙŠ Ø§Ù†Ø´Ø±Ù‡.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù„ÙØ±Øµ Ù…Ø§ ØªØªÙƒØ±Ø±ØŒ ÙˆØ§Ù„Ø¬Ø§Ø¯ ÙŠØ´ÙˆÙ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ØªØ¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ©ØŸ Ø§Ù„Ù‚Ù†Ø§Ø© ØªØªÙƒÙ„Ù… Ø¹Ù† Ù†ÙØ³Ù‡Ø§.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø¹Ø§Ù„Ù… Ù…Ù† Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙŠÙ†ØªØ¸Ø±Ùƒ Ø¨Ø¶ØºØ·Ø© Ø²Ø±.. Ø§Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø«Ù‚ØªÙŠ Ù‡ÙŠ Ø±Ø£Ø³ Ù…Ø§Ù„ÙŠØŒ ØªØ¹Ø§Ù„ ÙˆØ´ÙˆÙ Ø¨Ø¹ÙŠÙ†Ùƒ Ù„ÙŠØ´ Ø§Ù„ÙƒÙ„ ÙŠÙ…Ø¯Ø­Ù†ÙŠ.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù„Ù‚Ù†Ø§Ø© ÙÙŠÙ‡Ø§ Ø§Ø´ÙŠØ§Ø¡ Ù…Ø§ ØªÙ†ÙˆØµÙØŒ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ ÙŠÙ†ØªØ¸Ø±Ùƒ",
    "ØªØ¨ÙŠ ØªØºÙŠØ± Ø¬ÙˆÙƒ ÙˆØªØ´ÙˆÙ Ø§Ù„ØªÙ…ÙŠØ²ØŸ Ø§Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø§ÙŠÙˆ Ø§Ù„Ø­ÙŠÙ†",
    "Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù† Ø£Ø«Ø¨Øª Ù„Ùƒ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ÙƒÙ„Ø§Ù… ÙˆØ§Ù„ÙØ¹Ù„.. Ø§Ù„Ø¨Ø§ÙŠÙˆ ÙŠØ­ÙƒÙ…",
    "Ø§Ù„Ø³Ø± Ø§Ù„Ù„ÙŠ Ø§Ù„ÙƒÙ„ ÙŠØ¯ÙˆØ±Ù‡ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ù†Ø§Ø©.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù„Ù„ÙŠ ÙŠØ¯ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø«Ù‚Ø© ÙˆØ§Ù„Ø¬Ø¯ÙŠØ©ØŒ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙƒÙ„Ù‡Ø§ Ø¨Ø¢Ø®Ø± Ù…Ù‚Ø·Ø¹ Ø¨Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù†Ø²Ù„Øª Ø¹Ø±ÙˆØ¶ Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¬Ø§Ø¯ÙŠÙ† ÙÙ‚Ø·ØŒ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù…Ùˆ Ù…Ø¬Ø±Ø¯ Ù‚Ù†Ø§Ø©ØŒ Ù‡Ø°Ø§ Ù…Ø¬ØªÙ…Ø¹ÙŠ Ø§Ù„Ø®Ø§Øµ.. Ø§Ù†Ø¶Ù… Ù„Ù†Ø§ Ù…Ù† Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ÙƒÙ†Øª Ù…Ø«Ù„Ùƒ Ù…ØªØ±Ø¯Ø¯ØŒ Ø¨Ø³ Ù„Ù…Ø§ Ø¯Ø®Ù„Øª Ø§Ù„Ù‚Ù†Ø§Ø© ØªØºÙŠØ± ÙƒÙ„ Ø´ÙŠØ¡.. Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø£ÙˆÙ„ Ù…Ø±Ø© Ø£Ø¹Ø±Ø¶ Ù‡Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ØŒ Ø§Ù„Ø­Ù‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ø§Ù„Ø¬Ø¯ÙŠØ© Ø¹Ù†ÙˆØ§Ù†ÙŠØŒ ÙˆØ§Ù„Ø±Ø§Ø¨Ø· Ù…ÙƒØ§Ù†ÙŠ.. Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "ØªØ¨ØºÙ‰ ØªØªØ£ÙƒØ¯ØŸ Ø§Ù„Ø¨Ø§ÙŠÙˆ ÙŠØ­ÙƒÙ…",
    "Ø¹Ø§Ù„Ù… Ø«Ø§Ù†ÙŠ ÙŠÙ†ØªØ¸Ø±Ùƒ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ.. ØªØ¹Ø§Ù„",
    "Ø±Ø³Ø§Ù„Ø© ØºØ§Ù…Ø¶Ø©ØŸ Ù„Ø§ØŒ Ù‡Ø°Ø§ ÙˆØ§Ù‚Ø¹ ÙŠÙ†ØªØ¸Ø±Ùƒ Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ",
    "Ù„Ø§ ØªØ¶ÙŠØ¹ ÙˆÙ‚ØªÙƒØŒ Ø§Ù„Ø²Ø¨Ø¯Ø© ÙƒÙ„Ù‡Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„Ø¨Ø§ÙŠÙˆ"
]

EMOJIS = ["âœ¨", "ğŸ”¥", "ğŸš€", "ğŸ’", "ğŸŒŸ", "ğŸ‘‘", "ğŸ§¿", "ğŸ’«", "ğŸ¯", "ğŸ­", "ğŸŒ¹", "â¤ï¸", "ğŸ“", "âœ…", "ğŸ¬", "ğŸ¤", "ğŸ’°", "ğŸŒˆ", "ğŸ—ï¸", "ğŸ‘£"]
DECORATIONS = ["-", "â€”", "â€¢", "~", "â˜…", "â˜†", "Â»", "Â«", "â—ˆ", "â—‡"]

replied_users = set()

class HealthCheckHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        self.wfile.write(b"Ultra Strategy Active - 40 Messages Loaded")

def run_health_check():
    server = HTTPServer(('0.0.0.0', 8080), HealthCheckHandler)
    server.serve_forever()

def send_notification(text):
    try:
        url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
        payload = {"chat_id": MY_ID, "text": text, "parse_mode": "Markdown"}
        requests.post(url, json=payload, timeout=5)
    except: pass

async def start_bot():
    client = TelegramClient('High_Speed_Session', API_ID, API_HASH)
    
    try:
        await client.start(phone=PHONE_NUMBER)
        send_notification("ğŸš€ **ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¶Ø®Ù…!**\nØªÙ… Ø¥Ø¶Ø§ÙØ© 40 Ø¹Ø¨Ø§Ø±Ø© Ù…Ù†ÙˆØ¹Ø© Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø±Ù…ÙˆØ² ÙˆØ²Ø®Ø§Ø±Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠ.")

        @client.on(events.NewMessage(chats=TARGET_GROUP))
        async def handler(event):
            global replied_users
            if event.out: return

            user_id = event.sender_id

            # Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ 10% ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„ØªÙØ§Ø¯ÙŠ Ø§Ù„Ø­Ø¸Ø± ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
            if random.random() > 0.10: 
                return

            if user_id in replied_users:
                return

            try:
                # ØªÙˆÙ„ÙŠØ¯ Ø±Ø³Ø§Ù„Ø© ÙØ±ÙŠØ¯Ø© ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©
                chosen_text = random.choice(MY_MESSAGES)
                emoji_start = "".join(random.sample(EMOJIS, random.randint(1, 2)))
                emoji_end = "".join(random.sample(EMOJIS, random.randint(1, 2)))
                dec = random.choice(DECORATIONS)
                
                final_message = f"{dec} {emoji_start} {chosen_text} {emoji_end} {dec}"

                await asyncio.sleep(random.randint(10, 25))
                await event.reply(final_message)
                
                replied_users.add(user_id)
                
                # Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¨ÙˆØª
                sender = await event.get_sender()
                name = getattr(sender, 'first_name', 'User')
                send_notification(f"âœ… **Ø±Ø¯ Ø¬Ø¯ÙŠØ¯:**\nğŸ‘¤ {name}\nğŸ’¬ {chosen_text}")
                
                await asyncio.sleep(60) # Ø§Ø³ØªØ±Ø§Ø­Ø© Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø¨

            except Exception as e:
                print(f"Error: {e}")

        await client.run_until_disconnected()
        
    except Exception as e:
        send_notification(f"âŒ Ø®Ø·Ø£: {e}")

if __name__ == "__main__":
    threading.Thread(target=run_health_check, daemon=True).start()
    asyncio.run(start_bot())
